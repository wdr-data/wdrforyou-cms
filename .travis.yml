language: python

sudo: false

python:
- "3.6"

env:
  global:
    - AWS_REGION=eu-central-1
    - S3_BUCKET_NAME=newsforyou-static-staging
    - SECRET_KEY=a
    - BOT_SERVICE_ENDPOINT=https://example.com/

cache: pip

install:
  - pip install pipenv
  - pipenv sync --dev

script:
  - echo "No tests :)"

deploy:
  - provider: script
    skip_cleanup: true
    script: cd app && zappa update staging && zappa manage staging "migrate" && ./manage.py collectstatic --noinput
    on:
      branch: master

  - provider: script
    skip_cleanup: true
    script: cd app && zappa update prod && zappa manage prod "migrate" && ./manage.py collectstatic --noinput
    on:
      branch: production
